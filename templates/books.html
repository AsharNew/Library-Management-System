
books_html_correct = '''{% extends "base.html" %}

{% block title %}Books - Library Management System{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-book me-2"></i>All Books</h2>
    {% if session.role in ['admin', 'staff'] %}
    <a href="{{ url_for('add_book') }}" class="btn btn-primary">
        <i class="fas fa-plus me-2"></i>Add New Book
    </a>
    {% endif %}
</div>

<div class="card shadow">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead class="table-primary">
                    <tr>
                        <th>Title</th>
                        <th>Author</th>
                        <th>ISBN</th>
                        <th>Category</th>
                        <th>Available</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for book in books %}
                    <tr>
                        <td>
                            <strong>{{ book.title }}</strong>
                        </td>
                        <td>{{ book.author }}</td>
                        <td>{{ book.isbn }}</td>
                        <td>
                            <span class="badge bg-info">{{ book.category }}</span>
                        </td>
                        <td>
                            {% if book.available > 0 %}
                            <span class="badge bg-success">{{ book.available }} / {{ book.quantity }}</span>
                            {% else %}
                            <span class="badge bg-danger">{{ book.available }} / {{ book.quantity }}</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if session.role == 'student' %}
                                {% if book.available > 0 %}
                              <button class="btn btn-sm btn-success" onclick="borrowBook('{{ book.id }}')">

                                    <i class="fas fa-book-reader"></i> Borrow
                                </button>
                                {% endif %}
                            {% endif %}
                            
                            {% if session.role == 'admin' or session.role == 'staff' %}
                            <a href="{{ url_for('edit_book', book_id=book.id) }}" class="btn btn-sm btn-warning">
                                <i class="fas fa-edit"></i>
                            </a>
                            {% endif %}
                            
                            {% if session.role == 'admin' %}
                            <a href="{{ url_for('delete_book', book_id=book.id) }}" class="btn btn-sm btn-danger" onclick="return confirm('Delete this book?')">
                                <i class="fas fa-trash"></i>
                            </a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function borrowBook(bookId) {
    if (confirm('Borrow this book?')) {
        fetch('/issue-book/' + bookId, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert(data.message);
                location.reload();
            } else {
                alert(data.message);
            }
        })
        .catch(error => {
            alert('Error: ' + error);
        });
    }
}
</script>
{% endblock %}

